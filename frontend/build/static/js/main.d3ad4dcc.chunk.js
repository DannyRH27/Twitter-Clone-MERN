(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{43:function(e,t,n){e.exports=n(72)},72:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(21),o=n.n(u),s=n(2),c=n(9),i=n(42),l=n(16),p=function(e){return{loggedIn:e.session.isAuthenticated}},h=Object(l.g)(Object(s.b)(p)((function(e){var t=e.component,n=e.path,r=e.loggedIn,u=e.exact;return a.a.createElement(l.b,{path:n,exact:u,render:function(e){return r?a.a.createElement(l.a,{to:"/tweets"}):a.a.createElement(t,e)}})}))),E=Object(l.g)(Object(s.b)(p)((function(e){var t=e.component,n=e.loggedIn,r=Object(i.a)(e,["component","loggedIn"]);return a.a.createElement(l.b,Object.assign({},r,{render:function(e){return n?a.a.createElement(t,e):a.a.createElement(l.a,{to:"/login"})}}))}))),m=n(3),d=n(4),f=n(6),b=n(5),v=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h1",null,"A Twitter Clone"),a.a.createElement("footer",null,"Copyright \xa9 2019 Chirper"))}}]),n}(a.a.Component),w=n(15),g=n.n(w),O=function(e){e?g.a.defaults.headers.common.Authorization=e:delete g.a.defaults.headers.common.Authorization},j=n(23),y=n.n(j),S=function(e){return{type:"RECEIVE_SESSION_ERRORS",errors:e}},k=function(e){return function(t){return(n=e,g.a.post("/api/users/register",n)).then((function(){return t({type:"RECEIVE_USER_SIGN_IN"})}),(function(e){return t(S(e.response.data))}));var n}},T=function(e){return function(t){return(n=e,g.a.post("/api/users/login",n)).then((function(e){var n=e.data.token;localStorage.setItem("jwtToken",n),O(n);var r=y()(n);t({type:"RECEIVE_CURRENT_USER",currentUser:r})})).catch((function(e){t(S(e.response.data))}));var n}},R=function(){return function(e){localStorage.removeItem("jwtToken"),O(!1),e({type:"RECEIVE_USER_LOGOUT"})}},C=n(11),I=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).logoutUser=r.logoutUser.bind(Object(C.a)(r)),r.getLinks=r.getLinks.bind(Object(C.a)(r)),r}return Object(d.a)(n,[{key:"logoutUser",value:function(e){e.preventDefault(),this.props.logout()}},{key:"getLinks",value:function(){return this.props.loggedIn?a.a.createElement("div",null,a.a.createElement(c.b,{to:"./tweets"},"All Tweets"),a.a.createElement(c.b,{to:"./profile"},"Profile"),a.a.createElement(c.b,{to:"./new_tweet"},"Write a Tweet"),a.a.createElement("button",{onClick:this.logoutUser},"Logout")):a.a.createElement("div",null,a.a.createElement(c.b,{to:"signup"},"Signup"),a.a.createElement(c.b,{to:"login"},"Login"))}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h1",null,"Chirper"),this.getLinks())}}]),n}(a.a.Component),_=Object(s.b)((function(e){return{loggedIn:e.session.isAuthenticated}}),{logout:R})(I),U=n(18),x=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={email:"",password:"",errors:{}},r.handleSubmit=r.handleSubmit.bind(Object(C.a)(r)),r.renderErrors=r.renderErrors.bind(Object(C.a)(r)),r}return Object(d.a)(n,[{key:"componentWillReceiveProps",value:function(e){!0===e.currentUser&&this.props.history.push("/tweets"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(U.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,password:this.state.password};this.props.login(t)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map((function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])})))}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"})),a.a.createElement("input",{type:"submit",value:"Submit"}),this.renderErrors()))}}]),n}(a.a.Component),W=Object(l.g)(x),V=Object(s.b)((function(e){return{errors:e.errors.session}}),(function(e){return{login:function(t){return e(T(t))}}}))(W),N=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={email:"",handle:"",password:"",password2:"",errors:{}},r.handleSubmit=r.handleSubmit.bind(Object(C.a)(r)),r.clearedErrors=!1,r}return Object(d.a)(n,[{key:"componentWillReceiveProps",value:function(e){!0===e.signedIn&&this.props.history.push("/login"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(U.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,handle:this.state.handle,password:this.state.password,password2:this.state.password2};this.props.signup(t,this.props.history)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map((function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])})))}},{key:"render",value:function(){return a.a.createElement("div",{className:"signup-form-container"},a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",{className:"signup-form"},a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.handle,onChange:this.update("handle"),placeholder:"Handle"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password2,onChange:this.update("password2"),placeholder:"Confirm Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"submit",value:"Submit"}),this.renderErrors())))}}]),n}(a.a.Component),A=Object(l.g)(N),L=Object(s.b)((function(e){return{signedIn:e.session.isSignedIn,errors:e.errors.session}}),(function(e){return{signup:function(t){return e(k(t))}}}))(A),P=function(){return function(e){return g.a.get("/api/tweets").then((function(t){return e(function(e){return{type:"RECEIVE_TWEETS",tweets:e}}(t))})).catch((function(e){return console.log(e)}))}},D=function(e){return function(t){return function(e){return g.a.get("/api/tweets/user/".concat(e))}(e).then((function(e){return t(function(e){return{type:"RECEIVE_USER_TWEETS",tweets:e}}(e))})).catch((function(e){return console.log(e)}))}},z=function(e){return function(t){return function(e){return g.a.post("/api/tweets/",e)}(e).then((function(e){return t(function(e){return{type:"RECEIVE_NEW_TWEET",tweet:e}}(e))})).catch((function(e){return console.log(e)}))}},G=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(){return Object(m.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,this.props.text))}}]),n}(a.a.Component),M=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={tweets:[]},r}return Object(d.a)(n,[{key:"componentWillMount",value:function(){this.props.fetchTweets()}},{key:"componentWillReceiveProps",value:function(e){this.setState({tweets:e.tweets})}},{key:"render",value:function(){return 0===this.state.tweets.length?a.a.createElement("div",null,"There are no Tweets"):a.a.createElement("div",null,a.a.createElement("h2",null,"All Tweets"),this.state.tweets.map((function(e){return a.a.createElement(G,{key:e._id,text:e.text})})))}}]),n}(a.a.Component),J=Object(l.g)(M),B=Object(s.b)((function(e){return{tweets:Object.values(e.tweets.all)}}),(function(e){return{fetchTweets:function(){return e(P())}}}))(J),H=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={tweets:[]},r}return Object(d.a)(n,[{key:"componentWillMount",value:function(){console.log(this.props.currentUser.id),this.props.fetchUserTweets(this.props.currentUser.id)}},{key:"componentWillReceiveProps",value:function(e){this.setState({tweets:e.tweets})}},{key:"render",value:function(){return 0===this.state.tweets.length?a.a.createElement("div",null,"This user has no Tweets"):a.a.createElement("div",null,a.a.createElement("h2",null,"All of this user's tweets"),this.state.tweets.map((function(e){return a.a.createElement(G,{key:e._id,text:e.text})})))}}]),n}(a.a.Component),q=Object(s.b)((function(e){return{tweets:Object.values(e.tweets.user),currentUser:e.session.user}}),(function(e){return{fetchUserTweets:function(t){return e(D(t))}}}))(H),F=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var r;return Object(m.a)(this,n),(r=t.call(this,e)).state={text:"",newTweet:""},r.handleSubmit=r.handleSubmit.bind(Object(C.a)(r)),r}return Object(d.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({newTweet:e.newTweet.text})}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={text:this.state.text};this.props.composeTweet(t),this.setState({text:""})}},{key:"update",value:function(){var e=this;return function(t){return e.setState({text:t.currentTarget.value})}}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("input",{type:"textarea",value:this.state.text,onChange:this.update(),placeholder:"Write your tweet..."}),a.a.createElement("input",{type:"submit",value:"Submit"}))),a.a.createElement("br",null),a.a.createElement(G,{text:this.state.newTweet}))}}]),n}(a.a.Component),K=Object(s.b)((function(e){return{currentUser:e.session.user,newTweet:e.tweets.new}}),(function(e){return{composeTweet:function(t){return e(z(t))}}}))(F),Q=function(){return a.a.createElement("div",null,a.a.createElement(_,null),a.a.createElement(l.d,null,a.a.createElement(h,{exact:!0,path:"/",component:v}),a.a.createElement(h,{exact:!0,path:"/login",component:V}),a.a.createElement(h,{exact:!0,path:"/signup",component:L}),a.a.createElement(E,{exact:!0,path:"/tweets",component:B}),a.a.createElement(E,{exact:!0,path:"/profile",component:q}),a.a.createElement(E,{exact:!0,path:"/new_tweet",component:K})))},X=function(e){var t=e.store;return a.a.createElement(s.a,{store:t},a.a.createElement(c.a,null,a.a.createElement(Q,null)))},Y=n(14),Z=n(40),$=n(41),ee=n.n($),te=n(20),ne={isAuthenticated:!1,user:{}},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_SESSION_ERRORS":return t.errors;case"RECEIVE_CURRENT_USER":return[];default:return e}},ae=Object(Y.c)({session:re}),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{all:{},user:{},new:void 0},t=arguments.length>1?arguments[1]:void 0;Object.freeze(e);var n=Object.assign({},e);switch(t.type){case"RECEIVE_TWEETS":return n.all=t.tweets.data,n;case"RECEIVE_USER_TWEETS":return n.user=t.tweets.data,n;case"RECEIVE_NEW_TWEET":return n.new=t.tweet.data,n;default:return e}},oe=Object(Y.c)({tweets:ue,session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_CURRENT_USER":return Object(te.a)(Object(te.a)({},e),{},{isAuthenticated:!!t.currentUser,user:t.currentUser});case"RECEIVE_USER_SIGN_IN":return Object(te.a)(Object(te.a)({},e),{},{isSignedIn:!0});case"RECEIVE_USER_LOGOUT":return{isAuthenticated:!1,user:void 0};default:return e}},errors:ae}),se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(Y.d)(oe,e,Object(Y.a)(Z.a,ee.a))};document.addEventListener("DOMContentLoaded",(function(){var e;if(localStorage.jwtToken){O(localStorage.jwtToken);var t=y()(localStorage.jwtToken);e=se({session:{isAuthenticated:!0,user:t}});var n=Date.now()/1e3;t.exp<n&&(e.dispatch(R()),window.location.href="/login")}else e=se({});var r=document.getElementById("root");o.a.render(a.a.createElement(X,{store:e}),r)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.d3ad4dcc.chunk.js.map